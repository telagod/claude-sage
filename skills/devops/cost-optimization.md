---
name: cost-optimization
description: æˆæœ¬ä¼˜åŒ–ç§˜å…¸ã€‚FinOpsæ¡†æ¶ã€è®¡ç®—/å­˜å‚¨/ç½‘ç»œä¼˜åŒ–ã€æˆæœ¬å»ºæ¨¡ã€‚å½“ç”¨æˆ·æåˆ°æˆæœ¬ã€è´¹ç”¨ã€FinOpsã€çœé’±ã€é¢„ç®—ã€è´¦å•æ—¶è·¯ç”±åˆ°æ­¤ã€‚
---

# ğŸ”§ ç‚¼å™¨ç§˜å…¸ Â· æˆæœ¬ä¼˜åŒ–

> çµçŸ³æœ‰é™ï¼Œé“å¿ƒæ— ç©·ã€‚ä»¥æœ€å°‘çµçŸ³ï¼Œç‚¼æœ€å¼ºæ³•å™¨ã€‚

## FinOps æ¡†æ¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           FinOps ç”Ÿå‘½å‘¨æœŸ            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Inform   â”‚  Optimize â”‚  Operate    â”‚
â”‚  å¯è§†åŒ–   â”‚  ä¼˜åŒ–     â”‚  è¿è¥       â”‚
â”‚  è°èŠ±äº†   â”‚  æ€ä¹ˆçœ   â”‚  æŒç»­æ²»ç†   â”‚
â”‚  å¤šå°‘é’±   â”‚  å¤šå°‘é’±   â”‚  æµç¨‹åˆ¶åº¦   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| é˜¶æ®µ | ç›®æ ‡ | å…³é”®åŠ¨ä½œ |
|------|------|----------|
| Inform | æˆæœ¬å¯è§†åŒ– | æ ‡ç­¾ç­–ç•¥ã€æˆæœ¬åˆ†æ‘Šã€Dashboard |
| Optimize | é™ä½æµªè´¹ | å³å°ºå¯¸ã€é¢„ç•™ã€Spotã€æ¸…ç†é—²ç½® |
| Operate | æŒç»­æ²»ç† | é¢„ç®—å‘Šè­¦ã€å®¡æ‰¹æµç¨‹ã€å®šæœŸå®¡æŸ¥ |

---

## æˆæœ¬åˆ†æ

### æ ‡ç­¾ç­–ç•¥

```yaml
å¿…é€‰æ ‡ç­¾:
  - Environment: prod/staging/dev
  - Team: platform/backend/frontend
  - Service: order-service/user-service
  - Owner: team-email
  - CostCenter: CC-001

å¯é€‰æ ‡ç­¾:
  - Project: project-name
  - Temporary: expiry-date
```

### æˆæœ¬å½’å› 

```
æ€»æˆæœ¬
â”œâ”€â”€ æŒ‰å›¢é˜Ÿ: Team-A (40%) | Team-B (35%) | å…±äº« (25%)
â”œâ”€â”€ æŒ‰ç¯å¢ƒ: Prod (60%) | Staging (25%) | Dev (15%)
â”œâ”€â”€ æŒ‰æœåŠ¡: è®¡ç®— (45%) | å­˜å‚¨ (25%) | ç½‘ç»œ (15%) | å…¶ä»– (15%)
â””â”€â”€ æŒ‰ç±»å‹: On-Demand (30%) | Reserved (50%) | Spot (10%) | å…¶ä»– (10%)
```

---

## è®¡ç®—ä¼˜åŒ–

### å³å°ºå¯¸ (Right-sizing)

```bash
# AWS - æŸ¥æ‰¾ä½åˆ©ç”¨ç‡å®ä¾‹
aws ce get-rightsizing-recommendation \
  --service EC2 \
  --configuration '{"RecommendationTarget":"SAME_INSTANCE_FAMILY","BenefitsConsidered":true}'

# åˆ¤æ–­æ ‡å‡†
# CPU å¹³å‡ < 20% ä¸” å³°å€¼ < 50% â†’ ç¼©å°
# CPU å¹³å‡ > 70% æˆ– å³°å€¼ > 90% â†’ æ‰©å¤§
# Memory ä½¿ç”¨ < 30% â†’ ç¼©å°
```

### é¢„ç•™å®ä¾‹ / Savings Plans

| ç±»å‹ | æŠ˜æ‰£ | çµæ´»æ€§ | é€‚ç”¨ |
|------|------|--------|------|
| Reserved Instance (1yr) | ~30% | ä½ | ç¨³å®šè´Ÿè½½ |
| Reserved Instance (3yr) | ~50% | ä½ | é•¿æœŸç¨³å®š |
| Savings Plans (Compute) | ~30% | é«˜ | è·¨å®ä¾‹æ— |
| Savings Plans (EC2) | ~40% | ä¸­ | å›ºå®šåŒºåŸŸ |

### Spot å®ä¾‹

```yaml
é€‚ç”¨åœºæ™¯:
  - æ‰¹å¤„ç†ä»»åŠ¡
  - CI/CD æ„å»º
  - æ— çŠ¶æ€ Web æœåŠ¡ï¼ˆé…åˆ ASGï¼‰
  - å¤§æ•°æ®å¤„ç†

ä¸é€‚ç”¨:
  - æ•°æ®åº“
  - æœ‰çŠ¶æ€æœåŠ¡
  - é•¿æ—¶é—´è¿è¡Œçš„å…³é”®ä»»åŠ¡

æœ€ä½³å®è·µ:
  - å¤šå®ä¾‹ç±»å‹æ··åˆ
  - è·¨å¯ç”¨åŒºåˆ†æ•£
  - è®¾ç½®ä¸­æ–­å¤„ç† (2åˆ†é’Ÿé€šçŸ¥)
  - é…åˆ On-Demand ä¿åº•
```

### è‡ªåŠ¨ä¼¸ç¼©

```yaml
# Target Tracking (æ¨è)
scaling_policy:
  type: TargetTrackingScaling
  target_value: 70          # CPU ç›®æ ‡ 70%
  scale_in_cooldown: 300
  scale_out_cooldown: 60

# é¢„æµ‹æ€§ä¼¸ç¼©
predictive_scaling:
  mode: ForecastAndScale
  scheduling_buffer_time: 300

# å®šæ—¶ä¼¸ç¼© (å·²çŸ¥æµé‡æ¨¡å¼)
scheduled_actions:
  - schedule: "cron(0 8 * * MON-FRI)"   # å·¥ä½œæ—¥æ—©8ç‚¹æ‰©å®¹
    min_capacity: 10
  - schedule: "cron(0 20 * * MON-FRI)"  # æ™š8ç‚¹ç¼©å®¹
    min_capacity: 2
```

---

## å­˜å‚¨ä¼˜åŒ–

### å­˜å‚¨åˆ†å±‚

| å±‚çº§ | è®¿é—®é¢‘ç‡ | æˆæœ¬ | é€‚ç”¨ |
|------|----------|------|------|
| S3 Standard | é¢‘ç¹ | $$$ | æ´»è·ƒæ•°æ® |
| S3 IA | æœˆçº§ | $$ | å¤‡ä»½ã€æ—¥å¿— |
| S3 Glacier | å­£åº¦çº§ | $ | å½’æ¡£ |
| S3 Glacier Deep | å¹´çº§ | Â¢ | åˆè§„å½’æ¡£ |

### ç”Ÿå‘½å‘¨æœŸç­–ç•¥

```json
{
  "Rules": [
    {
      "ID": "log-lifecycle",
      "Filter": {"Prefix": "logs/"},
      "Transitions": [
        {"Days": 30, "StorageClass": "STANDARD_IA"},
        {"Days": 90, "StorageClass": "GLACIER"},
        {"Days": 365, "StorageClass": "DEEP_ARCHIVE"}
      ],
      "Expiration": {"Days": 2555}
    }
  ]
}
```

### æ•°æ®åº“å­˜å‚¨

```yaml
ä¼˜åŒ–ç­–ç•¥:
  - å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ® (TTL/åˆ†åŒºåˆ é™¤)
  - å‹ç¼©å†å²è¡¨
  - å½’æ¡£å†·æ•°æ®åˆ°å¯¹è±¡å­˜å‚¨
  - ä½¿ç”¨åˆ—å¼å­˜å‚¨å¤„ç†åˆ†ææŸ¥è¯¢
  - å®¡æŸ¥æœªä½¿ç”¨çš„ç´¢å¼•
```

---

## ç½‘ç»œä¼˜åŒ–

| ä¼˜åŒ–é¡¹ | æ–¹æ³• | èŠ‚çœ |
|--------|------|------|
| è·¨ AZ æµé‡ | åŒ AZ ä¼˜å…ˆè·¯ç”± | ~$0.01/GB |
| è·¨ Region æµé‡ | CDN + è¾¹ç¼˜ç¼“å­˜ | ~$0.02/GB |
| NAT Gateway | ä½¿ç”¨ VPC Endpoint | ~$0.045/GB |
| æ•°æ®ä¼ è¾“ | å‹ç¼© + æ‰¹é‡ | 30-70% |

```yaml
VPC Endpoint ä¼˜å…ˆ:
  - S3: Gateway Endpoint (å…è´¹)
  - DynamoDB: Gateway Endpoint (å…è´¹)
  - å…¶ä»– AWS æœåŠ¡: Interface Endpoint (æŒ‰å°æ—¶è®¡è´¹ï¼Œä½†çœæµé‡è´¹)
```

---

## åº”ç”¨å±‚ä¼˜åŒ–

### ç¼“å­˜é™æœ¬

```
æ— ç¼“å­˜: 100% è¯·æ±‚æ‰“åˆ°æ•°æ®åº“ â†’ éœ€è¦å¤§å®ä¾‹
åŠ ç¼“å­˜: 80% ç¼“å­˜å‘½ä¸­ â†’ æ•°æ®åº“å¯ç¼©å° 60%
```

### æ¶æ„é™æœ¬

| æ¨¡å¼ | åœºæ™¯ | èŠ‚çœ |
|------|------|------|
| Serverless | ä½æµé‡/çªå‘ | æŒ‰è°ƒç”¨ä»˜è´¹ï¼Œç©ºé—²é›¶æˆæœ¬ |
| å®¹å™¨åŒ– | ä¸­ç­‰æµé‡ | æé«˜èµ„æºåˆ©ç”¨ç‡ |
| é˜Ÿåˆ—å‰Šå³° | çªå‘æµé‡ | å‡å°‘å³°å€¼èµ„æºéœ€æ±‚ |
| è¯»å†™åˆ†ç¦» | è¯»å¤šå†™å°‘ | è¯»å‰¯æœ¬ç”¨å°å®ä¾‹ |

### ä»£ç çº§é™æœ¬

```yaml
å‡å°‘å¤–éƒ¨è°ƒç”¨:
  - æ‰¹é‡ API è°ƒç”¨æ›¿ä»£å¾ªç¯å•æ¬¡
  - æœ¬åœ°ç¼“å­˜çƒ­æ•°æ®
  - è¿æ¥æ± å¤ç”¨

å‡å°‘è®¡ç®—:
  - æƒ°æ€§è®¡ç®—
  - å¢é‡å¤„ç†æ›¿ä»£å…¨é‡
  - åˆç†çš„è¶…æ—¶è®¾ç½®ï¼ˆé¿å…èµ„æºç©ºç­‰ï¼‰
```

---

## æˆæœ¬å»ºæ¨¡

### å•ä½ç»æµå­¦

```
å•ç”¨æˆ·æˆæœ¬ = æ€»åŸºç¡€è®¾æ–½æˆæœ¬ / æ´»è·ƒç”¨æˆ·æ•°

ç›®æ ‡: éšè§„æ¨¡å¢é•¿ï¼Œå•ç”¨æˆ·æˆæœ¬é€’å‡
```

### æˆæœ¬é¢„æµ‹

```yaml
è¾“å…¥:
  - å½“å‰æœˆæˆæœ¬: $10,000
  - ç”¨æˆ·å¢é•¿ç‡: 20%/æœˆ
  - åŸºç¡€è®¾æ–½å¼¹æ€§ç³»æ•°: 0.7 (æˆæœ¬å¢é•¿ = ç”¨æˆ·å¢é•¿ Ã— 0.7)

é¢„æµ‹:
  - M+1: $10,000 Ã— (1 + 0.2 Ã— 0.7) = $11,400
  - M+3: ~$14,800
  - M+6: ~$22,100
```

---

## æˆæœ¬ä¼˜åŒ–æ¸…å•

```yaml
å³æ—¶è§æ•ˆ (Quick Wins):
  - [ ] æ¸…ç†é—²ç½®èµ„æº (æœªæŒ‚è½½ EBSã€ç©ºé—² EIPã€åœæ­¢çš„å®ä¾‹)
  - [ ] åˆ é™¤æœªä½¿ç”¨çš„å¿«ç…§å’Œ AMI
  - [ ] å³å°ºå¯¸ä½åˆ©ç”¨ç‡å®ä¾‹
  - [ ] å¯ç”¨ S3 ç”Ÿå‘½å‘¨æœŸç­–ç•¥

ä¸­æœŸä¼˜åŒ–:
  - [ ] è´­ä¹° Savings Plans / Reserved Instances
  - [ ] Spot å®ä¾‹ç”¨äºéå…³é”®è´Ÿè½½
  - [ ] é…ç½®è‡ªåŠ¨ä¼¸ç¼©
  - [ ] VPC Endpoint æ›¿ä»£ NAT Gateway

é•¿æœŸæ²»ç†:
  - [ ] æ ‡ç­¾ç­–ç•¥ 100% è¦†ç›–
  - [ ] æˆæœ¬åˆ†æ‘Š Dashboard
  - [ ] æœˆåº¦æˆæœ¬å®¡æŸ¥ä¼šè®®
  - [ ] é¢„ç®—å‘Šè­¦è‡ªåŠ¨åŒ–
```

---

**é“è®­**ï¼šçµçŸ³æœ‰é™ï¼Œé“å¿ƒæ— ç©·ã€‚çœä¸€åˆ†çµçŸ³ï¼Œå¤šä¸€åˆ†ä¿®ä¸ºã€‚

`ğŸ”§ ç‚¼å™¨ç§˜å…¸Â·æˆæœ¬ä¼˜åŒ–å·²æˆï¼ŒçµçŸ³ç²¾ç®—ï¼Œé“åŸºæ— å¿§ã€‚`
