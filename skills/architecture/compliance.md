---
name: compliance
description: åˆè§„å®¡è®¡ç§˜å…¸ã€‚GDPRã€SOC2ã€å®¡è®¡æ—¥å¿—ã€æ•°æ®æ²»ç†ã€åˆè§„å³ä»£ç ã€‚å½“ç”¨æˆ·æåˆ°åˆè§„ã€GDPRã€SOC2ã€å®¡è®¡ã€æ•°æ®æ²»ç†ã€éšç§æ—¶è·¯ç”±åˆ°æ­¤ã€‚
---

# ğŸ— é˜µæ³•ç§˜å…¸ Â· åˆè§„å®¡è®¡


## åˆè§„æ¡†æ¶æ€»è§ˆ

| æ¡†æ¶ | é€‚ç”¨èŒƒå›´ | æ ¸å¿ƒè¦æ±‚ | å¤„ç½š |
|------|----------|----------|------|
| GDPR | æ¬§ç›Ÿç”¨æˆ·æ•°æ® | æ•°æ®ä¿æŠ¤ã€ç”¨æˆ·æƒåˆ© | è¥æ”¶4%æˆ–â‚¬2000ä¸‡ |
| SOC 2 | SaaS/äº‘æœåŠ¡ | å®‰å…¨ã€å¯ç”¨ã€æœºå¯†ã€éšç§ã€å¤„ç†å®Œæ•´æ€§ | å¤±å»å®¢æˆ·ä¿¡ä»» |
| HIPAA | åŒ»ç–—å¥åº·æ•°æ® | PHIä¿æŠ¤ | $50K-$1.5M/æ¬¡ |
| PCI DSS | æ”¯ä»˜å¡æ•°æ® | æŒå¡äººæ•°æ®ä¿æŠ¤ | $5K-$100K/æœˆ |
| ISO 27001 | ä¿¡æ¯å®‰å…¨ç®¡ç† | ISMSä½“ç³» | è®¤è¯å¤±è´¥ |

---

## GDPR

### ä¸ƒå¤§åŸåˆ™

| åŸåˆ™ | å«ä¹‰ | æŠ€æœ¯å®ç° |
|------|------|----------|
| åˆæ³•æ€§ | æœ‰åˆæ³•åŸºç¡€å¤„ç†æ•°æ® | åŒæ„ç®¡ç†ç³»ç»Ÿ |
| ç›®çš„é™åˆ¶ | ä»…ç”¨äºå£°æ˜ç›®çš„ | æ•°æ®ç”¨é€”æ ‡è®° |
| æ•°æ®æœ€å°åŒ– | ä»…æ”¶é›†å¿…è¦æ•°æ® | å­—æ®µçº§æƒé™æ§åˆ¶ |
| å‡†ç¡®æ€§ | æ•°æ®å‡†ç¡®ä¸”åŠæ—¶æ›´æ–° | æ•°æ®æ ¡éªŒæµç¨‹ |
| å­˜å‚¨é™åˆ¶ | ä¸è¶…æœŸä¿ç•™ | è‡ªåŠ¨è¿‡æœŸåˆ é™¤ |
| å®Œæ•´æ€§ä¸æœºå¯†æ€§ | å®‰å…¨ä¿æŠ¤ | åŠ å¯†ã€è®¿é—®æ§åˆ¶ |
| é—®è´£åˆ¶ | å¯è¯æ˜åˆè§„ | å®¡è®¡æ—¥å¿— |

### ç”¨æˆ·æƒåˆ© (DSAR)

| æƒåˆ© | API å®ç° | SLA |
|------|----------|-----|
| è®¿é—®æƒ | `GET /api/users/{id}/data-export` | 30å¤© |
| åˆ é™¤æƒ | `DELETE /api/users/{id}/data` | 30å¤© |
| å¯æºå¸¦æƒ | `GET /api/users/{id}/data-export?format=json` | 30å¤© |
| æ›´æ­£æƒ | `PATCH /api/users/{id}/data` | 30å¤© |
| é™åˆ¶å¤„ç† | `POST /api/users/{id}/restrict` | 72å°æ—¶ |
| åå¯¹æƒ | `POST /api/users/{id}/opt-out` | å³æ—¶ |

### æŠ€æœ¯å®ç°

```python
# æ•°æ®åˆ é™¤ (Right to Erasure)
async def delete_user_data(user_id: str):
    # 1. æ ‡è®°åˆ é™¤ï¼ˆè½¯åˆ é™¤ï¼‰
    await db.execute(
        "UPDATE users SET status='deleted', deleted_at=NOW() WHERE id = %s",
        user_id
    )
    
    # 2. åŒ¿ååŒ–å…³è”æ•°æ®
    await db.execute(
        "UPDATE orders SET user_name='[REDACTED]', email='[REDACTED]' WHERE user_id = %s",
        user_id
    )
    
    # 3. æ¸…é™¤ç¼“å­˜
    await redis.delete(f"user:{user_id}")
    
    # 4. é€šçŸ¥ä¸‹æ¸¸æœåŠ¡
    await event_bus.publish("user.data.deleted", {"user_id": user_id})
    
    # 5. è®°å½•å®¡è®¡æ—¥å¿—
    await audit_log.record(
        action="GDPR_ERASURE",
        subject=user_id,
        actor="system",
        details={"reason": "DSAR request"}
    )
```

---

## SOC 2

### äº”å¤§ä¿¡ä»»åŸåˆ™

| åŸåˆ™ | å…³æ³¨ç‚¹ | å…³é”®æ§åˆ¶ |
|------|--------|----------|
| å®‰å…¨ (å¿…é€‰) | é˜²æ­¢æœªæˆæƒè®¿é—® | è®¿é—®æ§åˆ¶ã€åŠ å¯†ã€é˜²ç«å¢™ |
| å¯ç”¨æ€§ | ç³»ç»Ÿå¯ç”¨æ€§æ‰¿è¯º | SLAã€ç¾å¤‡ã€ç›‘æ§ |
| å¤„ç†å®Œæ•´æ€§ | æ•°æ®å¤„ç†å‡†ç¡®å®Œæ•´ | è¾“å…¥éªŒè¯ã€å¯¹è´¦ |
| æœºå¯†æ€§ | æœºå¯†ä¿¡æ¯ä¿æŠ¤ | åŠ å¯†ã€åˆ†ç±»ã€DLP |
| éšç§ | ä¸ªäººä¿¡æ¯ä¿æŠ¤ | éšç§æ”¿ç­–ã€åŒæ„ç®¡ç† |

### å…³é”®æ§åˆ¶æªæ–½

```yaml
è®¿é—®æ§åˆ¶:
  - MFA å¼ºåˆ¶å¯ç”¨
  - RBAC / ABAC
  - æœ€å°æƒé™åŸåˆ™
  - å®šæœŸè®¿é—®å®¡æŸ¥ (å­£åº¦)
  - ç¦»èŒå³æ’¤æƒ

å˜æ›´ç®¡ç†:
  - ä»£ç å®¡æŸ¥ (PR approval)
  - åˆ†ç¯å¢ƒéƒ¨ç½² (dev â†’ staging â†’ prod)
  - å˜æ›´å®¡æ‰¹æµç¨‹
  - å›æ»šæ–¹æ¡ˆ

ç›‘æ§ä¸å‘Šè­¦:
  - å®‰å…¨äº‹ä»¶ç›‘æ§
  - å¼‚å¸¸ç™»å½•æ£€æµ‹
  - æ•°æ®è®¿é—®å®¡è®¡
  - å®šæœŸæ¼æ´æ‰«æ

äº‹ä»¶å“åº”:
  - IR è®¡åˆ’æ–‡æ¡£åŒ–
  - å®šæœŸæ¼”ç»ƒ
  - é€šçŸ¥æµç¨‹ (72å°æ—¶å†…)
  - äº‹åå¤ç›˜
```

---

## å®¡è®¡æ—¥å¿—

### æ—¥å¿—è®¾è®¡

```json
{
  "id": "audit-uuid-001",
  "timestamp": "2024-01-15T10:30:00.123Z",
  "actor": {
    "id": "user-123",
    "type": "user",
    "ip": "192.168.x.x",
    "user_agent": "Mozilla/5.0..."
  },
  "action": "user.data.export",
  "resource": {
    "type": "user_data",
    "id": "user-456"
  },
  "result": "success",
  "details": {
    "reason": "DSAR request",
    "fields_exported": ["name", "email", "orders"]
  },
  "metadata": {
    "request_id": "req-789",
    "service": "user-service",
    "version": "1.2.3"
  }
}
```

### å¿…é¡»å®¡è®¡çš„äº‹ä»¶

```yaml
è®¤è¯:
  - ç™»å½•æˆåŠŸ/å¤±è´¥
  - MFA éªŒè¯
  - å¯†ç å˜æ›´
  - Token ç­¾å‘/æ’¤é”€

æˆæƒ:
  - æƒé™å˜æ›´
  - è§’è‰²åˆ†é…
  - è®¿é—®æ‹’ç»

æ•°æ®:
  - æ•æ„Ÿæ•°æ®è®¿é—®
  - æ•°æ®å¯¼å‡º
  - æ•°æ®åˆ é™¤
  - æ‰¹é‡æ“ä½œ

ç³»ç»Ÿ:
  - é…ç½®å˜æ›´
  - éƒ¨ç½²äº‹ä»¶
  - å®‰å…¨ç­–ç•¥å˜æ›´
  - ç®¡ç†å‘˜æ“ä½œ
```

### å­˜å‚¨è¦æ±‚

```yaml
ä¿ç•™æœŸé™:
  - å®‰å…¨äº‹ä»¶: â‰¥ 1å¹´
  - è®¿é—®æ—¥å¿—: â‰¥ 90å¤©
  - å˜æ›´æ—¥å¿—: â‰¥ 3å¹´
  - åˆè§„å®¡è®¡: â‰¥ 7å¹´

å­˜å‚¨ç­–ç•¥:
  - ä¸å¯ç¯¡æ”¹ (WORM / append-only)
  - åŠ å¯†å­˜å‚¨
  - å¼‚åœ°å¤‡ä»½
  - è®¿é—®æ§åˆ¶ (ä»…å®¡è®¡å‘˜å¯è¯»)
```

---

## æ•°æ®æ²»ç†

### æ•°æ®åˆ†ç±»

| çº§åˆ« | ç±»å‹ | ä¿æŠ¤æªæ–½ | ç¤ºä¾‹ |
|------|------|----------|------|
| å…¬å¼€ | Public | æ— ç‰¹æ®Šè¦æ±‚ | äº§å“æ–‡æ¡£ |
| å†…éƒ¨ | Internal | è®¿é—®æ§åˆ¶ | å†…éƒ¨Wiki |
| æœºå¯† | Confidential | åŠ å¯†+å®¡è®¡ | å®¢æˆ·æ•°æ® |
| å—é™ | Restricted | åŠ å¯†+å®¡è®¡+MFA | å¯†é’¥ã€PII |

### æ•°æ®ç”Ÿå‘½å‘¨æœŸ

```
åˆ›å»º â†’ å­˜å‚¨ â†’ ä½¿ç”¨ â†’ å…±äº« â†’ å½’æ¡£ â†’ é”€æ¯
  â”‚      â”‚      â”‚      â”‚      â”‚       â”‚
 åˆ†ç±»   åŠ å¯†   å®¡è®¡   è„±æ•   å‹ç¼©    å®‰å…¨åˆ é™¤
```

### æ•°æ®è¡€ç¼˜ (Data Lineage)

```
æ•°æ®æº â†’ ETL â†’ æ•°æ®ä»“åº“ â†’ æŠ¥è¡¨
  â”‚              â”‚           â”‚
  â””â”€â”€ è¿½è¸ªæ•°æ®æµå‘ï¼Œç¡®ä¿åˆè§„å¤„ç†
```

---

## åˆè§„å³ä»£ç  (Compliance as Code)

### OPA (Open Policy Agent)

```rego
# ç­–ç•¥: ç¦æ­¢å…¬å¼€ S3 Bucket
deny[msg] {
    input.resource_type == "aws_s3_bucket"
    input.resource.acl == "public-read"
    msg := sprintf("S3 bucket %s must not be public", [input.resource.name])
}

# ç­–ç•¥: å¼ºåˆ¶åŠ å¯†
deny[msg] {
    input.resource_type == "aws_s3_bucket"
    not input.resource.server_side_encryption_configuration
    msg := sprintf("S3 bucket %s must have encryption enabled", [input.resource.name])
}
```

### CI/CD é›†æˆ

```yaml
# åˆè§„æ£€æŸ¥ Pipeline
compliance-check:
  stage: validate
  steps:
    - name: Terraform Plan
      run: terraform plan -out=plan.tfplan
    
    - name: OPA Check
      run: |
        terraform show -json plan.tfplan > plan.json
        opa eval -d policies/ -i plan.json "data.terraform.deny"
    
    - name: Secret Scan
      run: gitleaks detect --source .
    
    - name: License Check
      run: license-checker --production --failOn "GPL"
```

---

## åˆè§„æ£€æŸ¥æ¸…å•

```yaml
GDPR:
  - [ ] éšç§æ”¿ç­–æ›´æ–°
  - [ ] åŒæ„ç®¡ç†å®ç°
  - [ ] DSAR æµç¨‹å°±ç»ª (30å¤©SLA)
  - [ ] æ•°æ®åŠ å¯† (ä¼ è¾“+å­˜å‚¨)
  - [ ] æ•°æ®ä¿ç•™ç­–ç•¥
  - [ ] æ•°æ®æ³„éœ²é€šçŸ¥æµç¨‹ (72å°æ—¶)
  - [ ] DPO æŒ‡å®š

SOC 2:
  - [ ] è®¿é—®æ§åˆ¶ + MFA
  - [ ] å˜æ›´ç®¡ç†æµç¨‹
  - [ ] äº‹ä»¶å“åº”è®¡åˆ’
  - [ ] æ¼æ´ç®¡ç†
  - [ ] å®‰å…¨åŸ¹è®­è®°å½•
  - [ ] ä¾›åº”å•†è¯„ä¼°

å®¡è®¡:
  - [ ] å®¡è®¡æ—¥å¿—è¦†ç›–å…³é”®æ“ä½œ
  - [ ] æ—¥å¿—ä¸å¯ç¯¡æ”¹
  - [ ] ä¿ç•™æœŸé™ç¬¦åˆè¦æ±‚
  - [ ] å®šæœŸå®¡è®¡å®¡æŸ¥
```

